<template>
  <div class="how-it-works-page">
    <!-- Hero Section -->
    <section class="hero-section">
      <div class="hero-content scroll-animate">
        <h1 class="hero-title">How RentCycle Works</h1>
        <p class="hero-subtitle">
          Your journey, your way. Here's how to get started as a renter or a host.
        </p>
      </div>
    </section>

    <!-- For Renters Section -->
    <section class="steps-section">
      <h2 class="section-title scroll-animate">For Renters</h2>
      <div class="steps-container">
        
        <!-- Renter Step 1: Find -->
        <div class="step-row">
          <div class="step-image-wrapper scroll-animate" style="--delay: 0s;">
            <img src="https://images.unsplash.com/photo-1622220401564-ca703e7dc1c1?q=80&w=1497&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="Discover vehicles" class="step-image"/>
          </div>
          <div class="step-text-content scroll-animate" style="--delay: 0.1s;">
            <div class="step-icon"><i class="bi bi-search"></i></div>
            <h3>1. Find Your Perfect Ride</h3>
            <p>Enter your location and dates to browse a wide selection of cars and motorcycles. Filter by make, price, vehicle type, and more to find exactly what you need for your trip.</p>
          </div>
        </div>

        <!-- Renter Step 2: Book & Verify -->
        <div class="step-row reverse">
          <div class="step-image-wrapper scroll-animate" style="--delay: 0s;">
            <img src="https://images.unsplash.com/photo-1517223144309-3989f10f97fd?q=80&w=1470&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="Book a car" class="step-image"/>
          </div>
          <div class="step-text-content scroll-animate" style="--delay: 0.1s;">
            <div class="step-icon"><i class="bi bi-patch-check-fill"></i></div>
            <h3>2. Book & Get Verified</h3>
            <p>Once you find a vehicle, send a booking request. If you're a new renter, you'll need to complete a quick, one-time verification by submitting your driver's license in your profile to get "Approved to Drive".</p>
          </div>
        </div>
        
        <!-- Renter Step 3: Pay & Connect -->
        <div class="step-row">
          <div class="step-image-wrapper scroll-animate" style="--delay: 0s;">
            <img src="https://images.unsplash.com/photo-1667566455648-262db767912b?q=80&w=1457&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="Pay for booking" class="step-image"/>
          </div>
          <div class="step-text-content scroll-animate" style="--delay: 0.1s;">
            <div class="step-icon"><i class="bi bi-qr-code"></i></div>
            <h3>3. Pay & Connect</h3>
            <p>After the host approves your request, you'll pay a 20% downpayment via QR code (like GCash) and submit the reference number. Once the host confirms, your trip is booked! A private chat will open for you to coordinate pickup details.</p>
          </div>
        </div>

        <!-- Renter Step 4: Drive & Review -->
        <div class="step-row reverse">
          <div class="step-image-wrapper scroll-animate" style="--delay: 0s;">
            <img src="https://images.unsplash.com/photo-1543215144-3d2954c44b20?q=80&w=1470&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="Drive a car" class="step-image"/>
          </div>
          <div class="step-text-content scroll-animate" style="--delay: 0.1s;">
            <div class="step-icon"><i class="bi bi-star-fill"></i></div>
            <h3>4. Drive & Review</h3>
            <p>Meet your host to pick up the keys (or follow their check-in instructions) and enjoy your trip! When you return the vehicle, the host will mark the trip as "Returned." You'll then be able to leave a review about your experience with the host and the vehicle.</p>
          </div>
        </div>

      </div>
    </section>

    <!-- For Hosts Section -->
    <section class="steps-section alternate-bg">
      <h2 class="section-title scroll-animate">For Hosts</h2>
      <div class="steps-container">
        
        <!-- Host Step 1: List -->
        <div class="step-row">
          <div class="step-image-wrapper scroll-animate" style="--delay: 0s;">
            <img src="https://images.unsplash.com/photo-1635322039171-4b9f2e0d5337?q=80&w=1074&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="List your vehicle" class="step-image"/>
          </div>
          <div class="step-text-content scroll-animate" style="--delay: 0.1s;">
            <div class="step-icon"><i class="bi bi-file-earmark-plus-fill"></i></div>
            <h3>1. List Your Asset</h3>
            <p>Earn extra income from your car or motorcycle. First, get verified as a host. Then, use our easy-to-use form to add photos, set your daily price, block unavailable dates, and list your vehicle in minutes.</p>
          </div>
        </div>

        <!-- Host Step 2: Approve & Verify -->
        <div class="step-row reverse">
          <div class="step-image-wrapper scroll-animate" style="--delay: 0s;">
            <img src="https://plus.unsplash.com/premium_photo-1661549683908-b11e9855c469?q=80&w=1471&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="Approve requests" class="step-image"/>
          </div>
          <div class="step-text-content scroll-animate" style="--delay: 0.1s;">
            <div class="step-icon"><i class="bi bi-check2-circle"></i></div>
            <h3>2. Approve & Verify</h3>
            <p>You'll receive notifications for new booking requests. You have full control to approve or decline any request. Once you approve, the renter will pay their downpayment. You just need to verify you've received it in your bank app.</p>
          </div>
        </div>

        <!-- Host Step 3: Earn -->
        <div class="step-row">
          <div class="step-image-wrapper scroll-animate" style="--delay: 0s;">
            <img src="https://plus.unsplash.com/premium_photo-1681051092990-a4ae89d32557?q=80&w=1074&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="Earn money" class="step-image"/>
          </div>
          <div class="step-text-content scroll-animate" style="--delay: 0.1s;">
            <div class="step-icon"><i class="bi bi-cash-stack"></i></div>
            <h3>3. Meet & Earn</h3>
            <p>Use the private chat to coordinate pickup with your renter. Collect the remaining 80% balance (and any security deposit) in person. When the trip is over and the vehicle is back, simply mark the booking as "Returned."</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Trust & Safety Section -->
    <section class="trust-section">
       <h2 class="section-title scroll-animate">Trust & Safety</h2>
       <div class="trust-content">
          <div class="trust-card scroll-animate" style="--delay: 0s;">
             <div class="info-icon"><i class="bi bi-shield-check"></i></div>
             <h3>Verified Users</h3>
             <p>All renters must be "Approved to Drive," and all hosts are verified before they can list. We ensure everyone is who they say they are.</p>
          </div>
          <div class="trust-card scroll-animate" style="--delay: 0.1s;">
             <div class="info-icon"><i class="bi bi-shield-lock-fill"></i></div>
             <h3>Secure Payments</h3>
             <p>Our 2-step payment process ensures you never give your vehicle keys without a confirmed downpayment, and renters never pay in full until they meet you.</p>
          </div>
          <div class="trust-card scroll-animate" style="--delay: 0.2s;">
             <div class="info-icon"><i class="bi bi-journal-check"></i></div>
             <h3>Rental Contracts</h3>
             <p>Every confirmed booking generates a downloadable rental agreement. We provide this to protect both the host and the renter for every single trip.</p>
          </div>
       </div>
    </section>
  </div>
</template>

<script>
export default {
  name: 'HowItWorksView',
  data() {
    return {
      observer: null,
    };
  },
  mounted() {
    const options = {
      root: null,
      threshold: 0.2,
      rootMargin: "0px",
    };

    this.observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('is-visible');
          this.observer.unobserve(entry.target);
        }
      });
    }, options);

    this.$nextTick(() => {
      const sections = this.$el.querySelectorAll('.scroll-animate');
      sections.forEach(section => {
        this.observer.observe(section);
      });
    });
  },
  beforeUnmount() {
    if (this.observer) {
      this.observer.disconnect();
    }
  },
};
</script>

<style lang="scss" scoped>
@import '@/assets/styles/variables.scss';

@keyframes kenburns-bg {
  0% { transform: scale(1) translate(0, 0); }
  100% { transform: scale(1.1) translate(-2%, 2%); }
}

.how-it-works-page {
  color: $text-color-dark;
  overflow-x: hidden;
}

// Hero Section
.hero-section {
  position: relative;
  overflow: hidden;
  padding: 6rem 2rem;
  text-align: center;
  color: white;

  &::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('https://images.unsplash.com/photo-1493238792000-8113da705763?q=80&w=1600');
    background-size: cover;
    background-position: center;
    animation: kenburns-bg 20s ease-in-out infinite alternate;
    z-index: 1;
    will-change: transform;
  }
  @media (max-width: 768px) { padding: 4rem 1.5rem; }
}
.hero-content { position: relative; z-index: 2; }
.hero-title {
  font-size: 3.5rem;
  font-weight: 900;
  margin-bottom: 1rem;
  @media (max-width: 768px) { font-size: 2.5rem; }
}
.hero-subtitle {
  font-size: 1.25rem;
  max-width: 800px;
  margin: 0 auto;
  line-height: 1.6;
  opacity: 0.9;
  @media (max-width: 768px) { font-size: 1rem; }
}

// Common Section Styling
section {
  padding: 6rem 2rem;
  max-width: 1200px;
  margin: 0 auto;
  @media (max-width: 768px) { padding: 3rem 1.5rem; }
}

.section-title {
  font-size: 2.5rem;
  font-weight: 700;
  margin-bottom: 3rem;
  text-align: center;
  color: $text-color-dark;
  @media (max-width: 768px) { font-size: 2rem; }
}

.steps-section.alternate-bg {
  background-color: $background-light;
}

// How It Works Steps
.steps-container {
  display: flex;
  flex-direction: column;
  gap: 4rem;
}
.step-row {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 3rem;
  align-items: center;

  &.reverse {
    .step-image-wrapper { order: 2; }
    .step-text-content { order: 1; }
  }

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
    gap: 2rem;
    &.reverse {
      .step-image-wrapper, .step-text-content {
        order: initial;
      }
    }
  }
}
.step-image-wrapper {
  border-radius: $border-radius-lg;
  overflow: hidden;
  box-shadow: $shadow-large;
}
.step-image {
  width: 100%;
  height: 100%;
  max-height: 400px;
  object-fit: cover;
  display: block;
}
.step-text-content {
  padding: 1rem;
  @media (max-width: 768px) {
    text-align: center;
    padding: 0;
  }
}
.step-icon {
  font-size: 3rem;
  color: $primary-color;
  margin-bottom: 1.5rem;
  display: inline-block;
}
.step-text-content h3 {
  font-size: 2rem;
  font-weight: 700;
  margin-top: 0;
  margin-bottom: 1rem;
}
.step-text-content p {
  color: $text-color-medium;
  line-height: 1.8;
  font-size: 1.1rem;
}

// Trust & Safety Section
.trust-section {
  background-color: #fdfdfd;
}
.trust-content {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 2rem;
}
.trust-card {
  background: $card-background;
  border: 1px solid $border-color-light;
  border-radius: $border-radius-lg;
  padding: 2rem;
  text-align: center;
  box-shadow: $shadow-light;
  
  .info-icon {
    font-size: 2.5rem;
    color: $secondary-color; // Use success color
    margin-bottom: 1rem;
    display: inline-block;
  }
  h3 {
    font-size: 1.25rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
  }
  p {
    color: $text-color-medium;
    line-height: 1.6;
    margin-bottom: 1rem;
  }
}

// Scroll Animation
.scroll-animate {
  opacity: 0;
  transform: translateY(40px);
  transition: opacity 0.6s ease-out, transform 0.6s ease-out;
  transition-delay: var(--delay, 0s);
  will-change: opacity, transform;

  &.is-visible {
    opacity: 1;
    transform: translateY(0);
  }
}
</style>