{"version":3,"file":"js/199.455bc899.js","mappings":"qOACOA,MAAM,2B,SAMWA,MAAM,c,SAIIA,MAAM,0B,SAKEA,MAAM,c,SAIhCA,MAAM,iB,GACTA,MAAM,iB,GAWJA,MAAM,c,GASLA,MAAM,e,iBASXA,MAAM,c,GAEJA,MAAM,e,GAKNA,MAAM,iB,GACJA,MAAM,gB,GAKNA,MAAM,gB,GAEJA,MAAM,gB,GAaRA,MAAM,gB,GAEHA,MAAM,gB,GAaTA,MAAM,gB,GAINA,MAAM,gB,GAINA,MAAM,gB,GAENA,MAAM,e,GAELA,MAAM,gB,GAOTA,MAAM,iB,0CA/GjBC,EAAAA,EAAAA,IA+HM,MA/HNC,EA+HM,C,eA9HJC,EAAAA,EAAAA,IAGM,OAHDH,MAAM,kBAAgB,EACzBG,EAAAA,EAAAA,IAA2C,MAAvCH,MAAM,cAAa,oBACvBG,EAAAA,EAAAA,IAA0F,KAAvFH,MAAM,iBAAgB,mE,IAGhBI,EAAAC,U,WAAXJ,EAAAA,EAAAA,IAEM,MAFNK,EAEM,IAAAC,EAAA,KAAAA,EAAA,KADJJ,EAAAA,EAAAA,IAAyB,SAAtB,sBAAkB,QAGPC,EAAAI,e,WAAhBP,EAAAA,EAAAA,IAGM,MAHNQ,EAGM,EAFJN,EAAAA,EAAAA,IAAyB,UAAAO,EAAAA,EAAAA,IAAnBN,EAAAI,cAAY,IAClBL,EAAAA,EAAAA,IAAmE,UAA1DQ,QAAKJ,EAAA,KAAAA,EAAA,OAAAK,IAAEC,EAAAC,cAAAD,EAAAC,gBAAAF,IAAcZ,MAAM,kBAAiB,YAGpB,IAAnBI,EAAAW,QAAQC,S,WAAxBf,EAAAA,EAAAA,IAEM,MAFNgB,EAEM,IAAAV,EAAA,KAAAA,EAAA,KADJJ,EAAAA,EAAAA,IAAgD,SAA7C,6CAAyC,U,WAG9CF,EAAAA,EAAAA,IA2BM,MA3BNiB,EA2BM,EA1BJf,EAAAA,EAAAA,IAyBQ,QAzBRgB,EAyBQ,C,eAxBNhB,EAAAA,EAAAA,IASQ,SATDH,MAAM,gBAAc,EACzBG,EAAAA,EAAAA,IAOK,YANHA,EAAAA,EAAAA,IAAa,UAAT,SACJA,EAAAA,EAAAA,IAAiB,UAAb,aACJA,EAAAA,EAAAA,IAAuB,UAAnB,mB,WAAoBA,EAAAA,EAAAA,IAAgB,UAAZ,YAC5BA,EAAAA,EAAAA,IAAgB,UAAZ,YACJA,EAAAA,EAAAA,IAAe,UAAX,WACJA,EAAAA,EAAAA,IAAgB,UAAZ,e,KAGRA,EAAAA,EAAAA,IAaQ,QAbRiB,EAaQ,G,aAZNnB,EAAAA,EAAAA,IAWKoB,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IAXgBlB,EAAAW,QAAVQ,K,WAAXtB,EAAAA,EAAAA,IAWK,MAX0BuB,IAAKD,EAAOE,GAAIzB,MAAM,a,EACnDG,EAAAA,EAAAA,IAA4C,WAAAO,EAAAA,EAAAA,IAArCG,EAAAa,WAAWH,EAAOI,aAAU,IACnCxB,EAAAA,EAAAA,IAAmC,WAAAO,EAAAA,EAAAA,IAA5Ba,EAAOK,eAAa,IAC3BzB,EAAAA,EAAAA,IAAgD,WAAAO,EAAAA,EAAAA,IAAzCa,EAAOM,mBAAqB,OAAJ,G,yBAAkB1B,EAAAA,EAAAA,IAA2D,WAAAO,EAAAA,EAAAA,IAApDa,EAAOO,aAAc,KAACpB,EAAAA,EAAAA,IAAGa,EAAOQ,cAAY,IACpG5B,EAAAA,EAAAA,IAA6B,WAAAO,EAAAA,EAAAA,IAAtBa,EAAOS,SAAO,IACrB7B,EAAAA,EAAAA,IAEK,YADHA,EAAAA,EAAAA,IAAwF,QAAlFH,OAAKiC,EAAAA,EAAAA,IAAA,CAAC,eAAc,UAAmBV,EAAOW,a,QAAaX,EAAOW,QAAM,MAEhF/B,EAAAA,EAAAA,IAEK,KAFLgC,EAEK,EADHhC,EAAAA,EAAAA,IAAoF,UAA3EQ,QAAKyB,GAAEvB,EAAAwB,kBAAkBd,GAASvB,MAAM,eAAc,eAAY,EAAAsC,S,aAO1ElC,EAAAmC,aAAenC,EAAAoC,iB,WAA1BvC,EAAAA,EAAAA,IA8EM,O,MA9EoCD,MAAM,gBAAiBW,QAAKJ,EAAA,KAAAA,EAAA,IAAAkC,EAAAA,EAAAA,IAAA,IAAA7B,IAAOC,EAAA6B,YAAA7B,EAAA6B,cAAA9B,GAAU,Y,EACrFT,EAAAA,EAAAA,IA4EM,MA5ENwC,EA4EM,C,eA3EJxC,EAAAA,EAAAA,IAA2C,MAAvCH,MAAM,eAAc,kBAAc,KACtCG,EAAAA,EAAAA,IAGM,MAHNyC,EAGM,EAFFzC,EAAAA,EAAAA,IAAqE,YAA/D,iBAAaO,EAAAA,EAAAA,IAAGG,EAAAa,WAAWtB,EAAAoC,eAAeb,aAAU,IAC1DxB,EAAAA,EAAAA,IAAiE,YAA3D,iBAAaO,EAAAA,EAAAA,IAAGN,EAAAoC,eAAeK,WAAa,OAAJ,MAGlD1C,EAAAA,EAAAA,IAsDM,MAtDN2C,EAsDM,EArDJ3C,EAAAA,EAAAA,IAGM,MAHN4C,EAGM,C,eAFJ5C,EAAAA,EAAAA,IAAgC,aAAzB,qBAAiB,KACxBA,EAAAA,EAAAA,IAAyE,UAAAO,EAAAA,EAAAA,IAAnEN,EAAAoC,eAAeV,aAAc,KAACpB,EAAAA,EAAAA,IAAGN,EAAAoC,eAAeT,cAAY,MAGpE5B,EAAAA,EAAAA,IAaM,MAbN6C,EAaM,C,eAZJ7C,EAAAA,EAAAA,IAAgC,aAAzB,qBAAiB,KACxBA,EAAAA,EAAAA,IAUM,MAVN8C,EAUM,EATF9C,EAAAA,EAAAA,IAAyC,UAAAO,EAAAA,EAAAA,IAAnCN,EAAAoC,eAAeZ,eAAa,GAExBxB,EAAAoC,eAAeU,a,WADzBjD,EAAAA,EAAAA,IAOU,U,MALLU,QAAKJ,EAAA,KAAAA,EAAA,GAAA6B,GAAEvB,EAAAsC,aAAa/C,EAAAoC,eAAeU,WAAY9C,EAAAoC,eAAeZ,gBAC/D5B,MAAM,mBACNoD,MAAM,4B,oBAEPjD,EAAAA,EAAAA,IAAoC,KAAjCH,MAAM,wBAAsB,e,oBAKxCG,EAAAA,EAAAA,IAaM,MAbNkD,EAaM,C,eAZJlD,EAAAA,EAAAA,IAA8B,aAAvB,mBAAe,KACrBA,EAAAA,EAAAA,IAUK,MAVLmD,EAUK,EATFnD,EAAAA,EAAAA,IAAsD,UAAAO,EAAAA,EAAAA,IAAhDN,EAAAoC,eAAeX,mBAAqB,OAAJ,GAE5BzB,EAAAoC,eAAee,kB,WADxBtD,EAAAA,EAAAA,IAOS,U,MALLU,QAAKJ,EAAA,KAAAA,EAAA,GAAA6B,GAAEvB,EAAAsC,aAAa/C,EAAAoC,eAAee,gBAAiBnD,EAAAoC,eAAeX,oBACpE7B,MAAM,mBACNoD,MAAM,kC,oBAEPjD,EAAAA,EAAAA,IAAoC,KAAjCH,MAAM,wBAAsB,e,oBAKxCG,EAAAA,EAAAA,IAGM,MAHNqD,EAGM,C,eAFFrD,EAAAA,EAAAA,IAA0B,aAAnB,eAAW,KAClBA,EAAAA,EAAAA,IAA8C,UAAAO,EAAAA,EAAAA,IAAxCN,EAAAoC,eAAeK,WAAa,OAAJ,MAElC1C,EAAAA,EAAAA,IAGM,MAHNsD,EAGM,C,eAFJtD,EAAAA,EAAAA,IAAqC,aAA9B,0BAAsB,KAC7BA,EAAAA,EAAAA,IAAmC,UAAAO,EAAAA,EAAAA,IAA7BN,EAAAoC,eAAeR,SAAO,MAE9B7B,EAAAA,EAAAA,IAGM,MAHNuD,EAGM,C,eAFJvD,EAAAA,EAAAA,IAA4B,aAArB,iBAAa,KACpBA,EAAAA,EAAAA,IAAsD,IAAtDwD,GAAsDjD,EAAAA,EAAAA,IAA5BN,EAAAoC,eAAeoB,QAAM,MAEhDzD,EAAAA,EAAAA,IAKM,MALN0D,EAKM,C,eAJF1D,EAAAA,EAAAA,IAAsB,aAAf,WAAO,KACdA,EAAAA,EAAAA,IAEI,WADFA,EAAAA,EAAAA,IAAwG,QAAlGH,OAAKiC,EAAAA,EAAAA,IAAA,CAAC,eAAc,UAAmB7B,EAAAoC,eAAeN,a,QAAa9B,EAAAoC,eAAeN,QAAM,UAIvG/B,EAAAA,EAAAA,IAaM,MAbN2D,EAaM,CAXK1D,EAAAoC,eAAeK,Y,WADvB5C,EAAAA,EAAAA,IAOS,U,MALNU,QAAKJ,EAAA,KAAAA,EAAA,OAAAK,IAAEC,EAAAkD,iBAAAlD,EAAAkD,mBAAAnD,IACRZ,MAAM,cACNoD,MAAM,0CACP,yB,gBAGDjD,EAAAA,EAAAA,IAA+D,UAAtDQ,QAAKJ,EAAA,KAAAA,EAAA,OAAAK,IAAEC,EAAA6B,YAAA7B,EAAA6B,cAAA9B,IAAYZ,MAAM,gBAAe,SACT,aAA1BI,EAAAoC,eAAeN,S,WAA7BjC,EAAAA,EAAAA,IAES,U,MAF4CU,QAAKJ,EAAA,KAAAA,EAAA,GAAA6B,GAAEvB,EAAAmD,cAAc5D,EAAAoC,eAAef,KAAKzB,MAAM,kBAAiB,wB,sFAahI,GACEiE,KAAM,mBACNC,IAAAA,GACE,MAAO,CACL7D,SAAS,EACTU,QAAS,GACTyB,eAAgB,KAChBD,aAAa,EACb/B,aAAc,KACd2D,YAAY,EAEhB,EACAC,SAAU,CACP,EAEHC,QAAS,KAEJC,EAAAA,EAAAA,IAAW,CAAC,sBAAuB,uBAAwB,8BAE9D,kBAAMxD,GACJyD,KAAKlE,SAAU,EACfkE,KAAK/D,aAAe,KACpB,IACE,MAAMgE,QAAuBD,KAAKE,sBAClCF,KAAKxD,QAAUyD,CACjB,CAAE,MAAOE,GACPC,QAAQD,MAAM,0BAA2BA,GACzCH,KAAK/D,aAAe,4CACpB+D,KAAKxD,QAAU,EACjB,CAAE,QACAwD,KAAKlE,SAAU,CACjB,CACF,EAEAqB,UAAAA,CAAWkD,GACT,IAAKA,EAAM,MAAO,MAClB,IACI,MAAMC,EAASD,EAAKE,OAASF,EAAKE,SAAW,IAAIC,KAAKH,GACrD,OAAII,MAAMH,EAAOI,WAAmB,eAC9BC,EAAAA,GAASC,WAAWN,GAAQO,SAAS,eAChD,CAAE,MAAOC,GAEL,OADAV,QAAQW,KAAK,yBAA0BV,EAAMS,GACtC,cACX,CACF,EACAhD,iBAAAA,CAAkBd,GAChBgD,KAAK/B,eAAiBjB,EACtBgD,KAAKhC,aAAc,CACrB,EACAG,UAAAA,GACE6B,KAAKhC,aAAc,EACnBgC,KAAK/B,eAAiB,IACxB,EACA,mBAAMwB,CAAcuB,GACjBZ,QAAQa,IAAI,gCAAgCD,QAC5C,UACWhB,KAAKkB,qBAAqBF,GAChC,MAAMhE,EAASgD,KAAKxD,QAAQ2E,KAAKC,GAAKA,EAAElE,KAAO8D,GAC3ChE,IACAA,EAAOW,OAAS,YAEpBqC,KAAK7B,aACLkD,MAAM,6BACX,CAAE,MAAMlB,GACJC,QAAQD,MAAM,0BAA0Ba,KAAab,GACrDkB,MAAM,6BAA6BlB,EAAMmB,UAAU3B,MAAM4B,SAAWpB,EAAMoB,UAC9E,CACH,EAEA/B,eAAAA,GACMQ,KAAK/B,gBAAkB+B,KAAK/B,eAAeK,WAC7C0B,KAAKwB,QAAQC,KAAK,CAAE/B,KAAM,mBAAoBgC,OAAQ,CAAEC,OAAQ3B,KAAK/B,eAAeK,aACpF0B,KAAK7B,eAELiC,QAAQW,KAAK,2EACbM,MAAM,4DAEV,EAEA,kBAAMzC,CAAagD,EAAcC,GAC7B,GAAKD,EAAL,CAIA5B,KAAKJ,YAAa,EAClBQ,QAAQa,IAAI,kDAAkDjB,KAAK/B,gBAAgBf,gBAAgB2E,GAAY,kBAAkBD,MACjI,IAGI,MAAMD,QAAe3B,KAAK8B,0BAA0BF,GAEpD,IAAID,EAMC,MAAM,IAAII,MAAM,6BAJjB/B,KAAKwB,QAAQC,KAAK,CAAE/B,KAAM,mBAAoBgC,OAAQ,CAAEC,OAAQA,KAChE3B,KAAK7B,YAKb,CAAE,MAAOgC,GACLC,QAAQD,MAAM,oCAAqCA,GACnDkB,MAAM,kCAAkClB,EAAMmB,UAAU3B,MAAM4B,SAAWpB,EAAMoB,UAEnF,CAAE,QACGvB,KAAKJ,YAAa,CACvB,CAtBA,MAFIyB,MAAM,4CAyBd,GAEFW,OAAAA,GACEhC,KAAKzD,cACP,G,UC9OF,MAAM0F,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,GAAQ,CAAC,YAAY,qBAEzF,O","sources":["webpack://vehicle-rental-frontend/./src/views/Dashboard/Admin/AdminReportsView.vue","webpack://vehicle-rental-frontend/./src/views/Dashboard/Admin/AdminReportsView.vue?f518"],"sourcesContent":["<template>\r\n  <div class=\"admin-reports-container\">\r\n    <div class=\"header-section\">\r\n      <h1 class=\"page-title\">Listing Reports</h1>\r\n      <p class=\"page-subtitle\">Review and manage user-submitted reports on vehicle listings.</p>\r\n    </div>\r\n\r\n    <div v-if=\"loading\" class=\"info-state\">\r\n      <p>Loading reports...</p>\r\n    </div>\r\n\r\n    <div v-else-if=\"errorMessage\" class=\"info-state error-state\">\r\n      <p>{{ errorMessage }}</p>\r\n      <button @click=\"fetchReports\" class=\"button primary\">Retry</button>\r\n    </div>\r\n\r\n    <div v-else-if=\"reports.length === 0\" class=\"info-state\">\r\n      <p>There are currently no reports to review.</p>\r\n    </div>\r\n\r\n    <div v-else class=\"table-wrapper\">\r\n      <table class=\"reports-table\">\r\n        <thead class=\"table-header\">\r\n          <tr>\r\n            <th>Date</th>\r\n            <th>Reporter</th>\r\n            <th>Reported Party</th> <th>Vehicle</th>\r\n            <th>Subject</th>\r\n            <th>Status</th>\r\n            <th>Actions</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody class=\"table-body\">\r\n          <tr v-for=\"report in reports\" :key=\"report.id\" class=\"table-row\">\r\n            <td>{{ formatDate(report.reportedAt) }}</td>\r\n            <td>{{ report.reporterEmail }}</td>\r\n            <td>{{ report.reportedPartyName || 'N/A' }}</td> <td>{{ report.vehicleMake }} {{ report.vehicleModel }}</td>\r\n            <td>{{ report.subject }}</td>\r\n            <td>\r\n              <span class=\"status-badge\" :class=\"`status-${report.status}`\">{{ report.status }}</span>\r\n            </td>\r\n            <td class=\"action-cell\">\r\n              <button @click=\"viewReportDetails(report)\" class=\"button view\">View Details</button>\r\n            </td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n\r\n    <div v-if=\"isModalOpen && selectedReport\" class=\"modal-overlay\" @click.self=\"closeModal\">\r\n      <div class=\"modal-card\">\r\n        <h3 class=\"modal-title\">Report Details</h3>\r\n        <div class=\"report-meta\">\r\n            <span>Reported On: {{ formatDate(selectedReport.reportedAt) }}</span>\r\n            <span>Booking ID: #{{ selectedReport.bookingId || 'N/A' }}</span>\r\n        </div>\r\n\r\n        <div class=\"modal-content\">\r\n          <div class=\"detail-group\">\r\n            <label>Reported Vehicle:</label>\r\n            <p>{{ selectedReport.vehicleMake }} {{ selectedReport.vehicleModel }}</p>\r\n          </div>\r\n\r\n          <div class=\"detail-group\">\r\n            <label>Reporter Contact:</label>\r\n            <div class=\"contact-line\">\r\n                <p>{{ selectedReport.reporterEmail }}</p>\r\n                <button\r\n                    v-if=\"selectedReport.reporterId\"\r\n                    @click=\"chatWithUser(selectedReport.reporterId, selectedReport.reporterEmail)\"\r\n                    class=\"button chat-icon\"\r\n                    title=\"Start chat with reporter\"\r\n                 >\r\n                   <i class=\"bi bi-chat-dots-fill\"></i>\r\n                 </button>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"detail-group\">\r\n            <label>Reported Party:</label>\r\n             <div class=\"contact-line\">\r\n                <p>{{ selectedReport.reportedPartyName || 'N/A' }}</p>\r\n                 <button\r\n                    v-if=\"selectedReport.reportedPartyId\"\r\n                    @click=\"chatWithUser(selectedReport.reportedPartyId, selectedReport.reportedPartyName)\"\r\n                    class=\"button chat-icon\"\r\n                    title=\"Start chat with reported party\"\r\n                 >\r\n                   <i class=\"bi bi-chat-dots-fill\"></i>\r\n                 </button>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"detail-group\">\r\n              <label>Booking ID:</label>\r\n              <p>{{ selectedReport.bookingId || 'N/A' }}</p>\r\n          </div>\r\n          <div class=\"detail-group\">\r\n            <label>Subject (Reason Code):</label>\r\n            <p>{{ selectedReport.subject }}</p>\r\n          </div>\r\n          <div class=\"detail-group\">\r\n            <label>Full Details:</label>\r\n            <p class=\"reason-text\">{{ selectedReport.reason }}</p>\r\n          </div>\r\n           <div class=\"detail-group\">\r\n               <label>Status:</label>\r\n               <p>\r\n                 <span class=\"status-badge\" :class=\"`status-${selectedReport.status}`\">{{ selectedReport.status }}</span>\r\n               </p>\r\n           </div>\r\n        </div>\r\n        <div class=\"modal-actions\">\r\n           <button\r\n             v-if=\"selectedReport.bookingId\"\r\n             @click=\"goToBookingChat\"\r\n             class=\"button chat\"\r\n             title=\"View chat associated with this booking\"\r\n           >\r\n             View Booking Chat\r\n           </button>\r\n           <button @click=\"closeModal\" class=\"button close\">Close</button>\r\n           <button v-if=\"selectedReport.status !== 'resolved'\" @click=\"resolveReport(selectedReport.id)\" class=\"button resolve\">\r\n               Mark as Resolved\r\n           </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapActions } from 'vuex'; // Import mapActions\r\nimport { DateTime } from 'luxon';\r\n\r\nexport default {\r\n  name: 'AdminReportsView',\r\n  data() {\r\n    return {\r\n      loading: true,\r\n      reports: [],\r\n      selectedReport: null,\r\n      isModalOpen: false,\r\n      errorMessage: null,\r\n      isChatting: false, // Add loading state for chat initiation\r\n    };\r\n  },\r\n  computed: {\r\n     // No mapGetters needed currently\r\n  },\r\n  methods: {\r\n    // Map the Vuex actions\r\n    ...mapActions(['fetchBookingReports', 'resolveBookingReport', 'findOrCreateAdminUserChat']), // Added findOrCreateAdminUserChat\r\n\r\n    async fetchReports() {\r\n      this.loading = true;\r\n      this.errorMessage = null;\r\n      try {\r\n        const fetchedReports = await this.fetchBookingReports();\r\n        this.reports = fetchedReports;\r\n      } catch (error) {\r\n        console.error(\"Error fetching reports:\", error);\r\n        this.errorMessage = \"Failed to load reports. Please try again.\";\r\n        this.reports = [];\r\n      } finally {\r\n        this.loading = false;\r\n      }\r\n    },\r\n\r\n    formatDate(date) {\r\n      if (!date) return 'N/A';\r\n      try {\r\n          const jsDate = date.toDate ? date.toDate() : new Date(date);\r\n           if (isNaN(jsDate.getTime())) return 'Invalid Date';\r\n          return DateTime.fromJSDate(jsDate).toFormat('LLL dd, yyyy');\r\n      } catch (e) {\r\n          console.warn(\"Error formatting date:\", date, e);\r\n          return 'Invalid Date';\r\n      }\r\n    },\r\n    viewReportDetails(report) {\r\n      this.selectedReport = report;\r\n      this.isModalOpen = true;\r\n    },\r\n    closeModal() {\r\n      this.isModalOpen = false;\r\n      this.selectedReport = null;\r\n    },\r\n    async resolveReport(reportId) {\r\n       console.log(`Attempting to resolve report ${reportId}...`);\r\n       try {\r\n            await this.resolveBookingReport(reportId);\r\n            const report = this.reports.find(r => r.id === reportId);\r\n            if (report) {\r\n                report.status = 'resolved';\r\n            }\r\n            this.closeModal();\r\n            alert('Report marked as resolved.');\r\n       } catch(error) {\r\n           console.error(`Error resolving report ${reportId}:`, error);\r\n           alert(`Failed to resolve report: ${error.response?.data?.message || error.message}`);\r\n       }\r\n    },\r\n    // Method to navigate to the main booking chat\r\n    goToBookingChat() {\r\n      if (this.selectedReport && this.selectedReport.bookingId) {\r\n        this.$router.push({ name: 'ChatConversation', params: { chatId: this.selectedReport.bookingId } });\r\n        this.closeModal();\r\n      } else {\r\n        console.warn(\"Cannot navigate to chat: bookingId is missing from the selected report.\");\r\n        alert(\"Booking ID is missing for this report, cannot open chat.\");\r\n      }\r\n    },\r\n    // Method triggered by the small chat icons - NOW IMPLEMENTED\r\n    async chatWithUser(targetUserId, userName) {\r\n        if (!targetUserId) {\r\n            alert(\"Cannot initiate chat: User ID is missing.\");\r\n            return;\r\n        }\r\n        this.isChatting = true; // Set loading state for the chat button if needed\r\n        console.log(`ADMIN ACTION: Finding/Creating chat for report ${this.selectedReport?.id} with user ${userName || 'Unknown'} (ID: ${targetUserId})`);\r\n        try {\r\n            // Dispatch Vuex action, passing the target user's ID\r\n            // This action calls the backend to find/create the chat and returns the chatId\r\n            const chatId = await this.findOrCreateAdminUserChat(targetUserId);\r\n\r\n            if (chatId) {\r\n                // Navigate to the chat view using the returned chatId\r\n                this.$router.push({ name: 'ChatConversation', params: { chatId: chatId } });\r\n                this.closeModal(); // Close the report modal after navigating\r\n            } else {\r\n                 // This case should ideally be handled within the Vuex action's error handling\r\n                 throw new Error(\"Chat ID was not returned.\");\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Error initiating admin-user chat:\", error);\r\n            alert(`Could not open or create chat: ${error.response?.data?.message || error.message}`);\r\n            // Keep the modal open on error\r\n        } finally {\r\n             this.isChatting = false; // Reset loading state\r\n        }\r\n    },\r\n  },\r\n  created() {\r\n    this.fetchReports();\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import '@/assets/styles/variables.scss';\r\n\r\n.admin-reports-container {\r\n  max-width: 1200px;\r\n  margin: 2rem auto;\r\n  padding: 0 1rem;\r\n}\r\n\r\n.header-section {\r\n  text-align: center;\r\n  margin-bottom: 3rem;\r\n}\r\n\r\n.page-title {\r\n  font-size: 2.25rem;\r\n  font-weight: 700;\r\n  color: $text-color-dark;\r\n}\r\n\r\n.page-subtitle {\r\n  font-size: 1.1rem;\r\n  color: $text-color-medium;\r\n  margin-top: 0.5rem;\r\n}\r\n\r\n.info-state {\r\n  text-align: center;\r\n  padding: 4rem 0;\r\n  color: $text-color-medium;\r\n  font-size: 1.2rem;\r\n}\r\n\r\n.error-state {\r\n  color: $admin-color;\r\n  background-color: lighten($admin-color, 45%);\r\n  border: 1px solid lighten($admin-color, 35%);\r\n  border-radius: $border-radius-md;\r\n  padding: 2rem;\r\n  button { margin-top: 1rem; }\r\n}\r\n\r\n\r\n.table-wrapper {\r\n  overflow-x: auto;\r\n  border: 1px solid $border-color-light;\r\n  border-radius: $border-radius-lg;\r\n  box-shadow: $shadow-small;\r\n  background-color: #fff;\r\n}\r\n\r\n.reports-table {\r\n  min-width: 100%;\r\n  border-collapse: collapse;\r\n  width: 100%;\r\n}\r\n\r\n.table-header {\r\n  background-color: #f9fafb;\r\n  th {\r\n    padding: 0.75rem 1rem;\r\n    text-align: left;\r\n    font-size: 0.75rem;\r\n    font-weight: 600;\r\n    color: $text-color-medium;\r\n    text-transform: uppercase;\r\n    letter-spacing: 0.05em;\r\n  }\r\n}\r\n\r\n.table-body .table-row {\r\n  border-top: 1px solid $border-color-light;\r\n  transition: background-color 0.15s ease-in-out;\r\n  &:hover {\r\n    background-color: lighten($primary-color, 48%);\r\n  }\r\n}\r\n\r\ntd {\r\n  padding: 0.75rem 1rem;\r\n  white-space: nowrap;\r\n  font-size: 0.85rem;\r\n  color: $text-color-dark;\r\n  text-align: left;\r\n  vertical-align: middle;\r\n}\r\n\r\n.action-cell {\r\n    text-align: right;\r\n}\r\n\r\n.status-badge {\r\n  display: inline-block;\r\n  padding: 0.25rem 0.6rem;\r\n  border-radius: $border-radius-pill;\r\n  font-weight: 600;\r\n  font-size: 0.7rem;\r\n  text-transform: capitalize;\r\n  line-height: 1.2;\r\n\r\n  &.status-submitted, &.status-new {\r\n    background-color: #fee2e2;\r\n    color: #991b1b;\r\n    border: 1px solid #fecaca;\r\n  }\r\n  &.status-resolved {\r\n    background-color: #d1fae5;\r\n    color: #065f46;\r\n    border: 1px solid #a7f3d0;\r\n  }\r\n   &.status-investigating {\r\n     background-color: #FEF3C7;\r\n     color: #92400E;\r\n     border: 1px solid #FDE68A;\r\n   }\r\n}\r\n\r\n.button {\r\n  padding: 0.4rem 0.8rem;\r\n  border-radius: $border-radius-md;\r\n  font-size: 0.8rem;\r\n  font-weight: 600;\r\n  border: none;\r\n  cursor: pointer;\r\n  transition: all 0.2s ease;\r\n  white-space: nowrap;\r\n\r\n  &.view {\r\n    background-color: #e0f2fe;\r\n    color: #0284c7;\r\n    &:hover { background-color: darken(#e0f2fe, 4%); }\r\n  }\r\n   &.primary {\r\n     background-color: $primary-color; color: white;\r\n     &:hover { background-color: darken($primary-color, 8%); }\r\n   }\r\n}\r\n\r\n/* Modal Styles */\r\n.modal-overlay {\r\n  position: fixed; top: 0; left: 0; width: 100%; height: 100%;\r\n  background-color: rgba(0, 0, 0, 0.6); display: flex;\r\n  justify-content: center; align-items: center; z-index: 1000;\r\n  padding: 1rem;\r\n}\r\n.modal-card {\r\n  background: white; padding: 2rem; border-radius: $border-radius-lg;\r\n  width: 90%; max-width: 650px;\r\n  max-height: 90vh;\r\n  overflow-y: auto;\r\n  box-shadow: $shadow-large;\r\n}\r\n.modal-title {\r\n  font-size: 1.4rem;\r\n  font-weight: 600;\r\n  margin: 0 0 0.75rem; /* Reduced bottom margin */\r\n  padding-bottom: 0; /* Remove padding if border is removed */\r\n  border-bottom: none; /* Remove border if meta section has one */\r\n  text-align: left;\r\n}\r\n.report-meta {\r\n    font-size: 0.85rem;\r\n    color: $text-color-medium;\r\n    margin-bottom: 1.5rem;\r\n    padding-bottom: 0.75rem;\r\n    border-bottom: 1px solid $border-color-light;\r\n    text-align: left;\r\n    display: flex;\r\n    justify-content: space-between;\r\n    flex-wrap: wrap;\r\n    gap: 0.5rem;\r\n}\r\n.modal-content {\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 1rem;\r\n    text-align: left;\r\n}\r\n.detail-group {\r\n    label {\r\n        font-weight: 600;\r\n        font-size: 0.75rem;\r\n        color: $text-color-medium;\r\n        display: block;\r\n        margin-bottom: 0.25rem;\r\n        text-transform: uppercase;\r\n    }\r\n    p {\r\n        margin: 0;\r\n        color: $text-color-dark;\r\n        font-size: 0.95rem;\r\n        word-break: break-word;\r\n    }\r\n    .reason-text {\r\n        white-space: pre-wrap;\r\n        line-height: 1.6;\r\n        background-color: #f8f9fa;\r\n        padding: 0.75rem;\r\n        border-radius: $border-radius-sm;\r\n        border: 1px solid $border-color-light;\r\n        max-height: 200px;\r\n        overflow-y: auto;\r\n    }\r\n}\r\n.contact-line {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    gap: 0.5rem;\r\n}\r\n.button.chat-icon {\r\n    background: none;\r\n    border: none;\r\n    color: $primary-color;\r\n    padding: 0.25rem;\r\n    font-size: 1.1rem;\r\n    line-height: 1;\r\n    margin-left: 0.5rem;\r\n    cursor: pointer; // Ensure cursor changes\r\n    &:hover {\r\n        color: darken($primary-color, 15%);\r\n        background-color: lighten($primary-color, 45%);\r\n    }\r\n}\r\n.modal-actions {\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    justify-content: flex-end;\r\n    align-items: center;\r\n    gap: 0.75rem;\r\n    margin-top: 2rem;\r\n    padding-top: 1rem;\r\n    border-top: 1px solid $border-color-light;\r\n}\r\n.button.chat { /* Style for \"View Booking Chat\" */\r\n    background-color: #e0e7ff;\r\n    color: #4338ca;\r\n    margin-right: auto; // Pushes other buttons right\r\n    &:hover { background-color: darken(#e0e7ff, 5%); }\r\n}\r\n.button.close {\r\n    background-color: #f3f4f6;\r\n    color: $text-color-dark;\r\n    border: 1px solid $border-color;\r\n     &:hover { background-color: darken(#f3f4f6, 5%); }\r\n}\r\n.button.resolve {\r\n    background-color: $secondary-color;\r\n    color: white;\r\n    border: 1px solid $secondary-color;\r\n     &:hover { background-color: darken($secondary-color, 10%); border-color: darken($secondary-color, 10%); }\r\n}\r\n</style>","import { render } from \"./AdminReportsView.vue?vue&type=template&id=1b7d5ee8&scoped=true\"\nimport script from \"./AdminReportsView.vue?vue&type=script&lang=js\"\nexport * from \"./AdminReportsView.vue?vue&type=script&lang=js\"\n\nimport \"./AdminReportsView.vue?vue&type=style&index=0&id=1b7d5ee8&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-1b7d5ee8\"]])\n\nexport default __exports__"],"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","$data","loading","_hoisted_2","_cache","errorMessage","_hoisted_3","_toDisplayString","onClick","args","$options","fetchReports","reports","length","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_Fragment","_renderList","report","key","id","formatDate","reportedAt","reporterEmail","reportedPartyName","vehicleMake","vehicleModel","subject","_normalizeClass","status","_hoisted_8","$event","viewReportDetails","_hoisted_9","isModalOpen","selectedReport","_withModifiers","closeModal","_hoisted_10","_hoisted_11","bookingId","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","reporterId","chatWithUser","title","_hoisted_16","_hoisted_17","reportedPartyId","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","reason","_hoisted_22","_hoisted_23","goToBookingChat","resolveReport","name","data","isChatting","computed","methods","mapActions","this","fetchedReports","fetchBookingReports","error","console","date","jsDate","toDate","Date","isNaN","getTime","DateTime","fromJSDate","toFormat","e","warn","reportId","log","resolveBookingReport","find","r","alert","response","message","$router","push","params","chatId","targetUserId","userName","findOrCreateAdminUserChat","Error","created","__exports__","render"],"sourceRoot":""}